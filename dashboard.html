<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>AI Rhythm Master - ì‹¤ì‹œê°„ í†µê³„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background-color: #f4f7f6; font-family: 'Pretendard', sans-serif; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary-grid { display: grid; grid-template-columns: repeat(3, 1/3); gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; }
        .card h3 { margin: 0; color: #666; font-size: 16px; }
        .card p { font-size: 28px; font-weight: bold; margin: 10px 0; color: #1a1a2e; }
        .chart-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        canvas { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š AI ë¦¬ë“¬ ë§ˆìŠ¤í„° ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</h1>
            <p>ì´ë‹´ì´ˆë“±í•™êµ ì •ë³´ê³¼í•™ë¶€ ë°ì´í„° ë¶„ì„ ì‹œìŠ¤í…œ</p>
        </div>

        <div class="summary-grid">
            <div class="card"><h3>ì´ í”Œë ˆì´ íšŸìˆ˜</h3><p id="total-games">0</p></div>
            <div class="card"><h3>í‰ê·  ì •í™•ë„</h3><p id="avg-acc">0%</p></div>
            <div class="card"><h3>ìµœê³  ì ìˆ˜</h3><p id="high-score">0</p></div>
        </div>

        <div class="chart-container">
            <canvas id="poseChart"></canvas>
            <canvas id="trendChart"></canvas>
        </div>
    </div>

    <script>
        // ë¶€ì¥ë‹˜ì˜ ì›¹ ì•± URL
        const apiURL = "https://script.google.com/macros/s/AKfycbyNsrl2qXOpxWAI830Xb3Tts2MJshS7ahe0tbOFTC5sHsAWVkC5jyShkKTB5SFLhmM/exec";

        async function updateDashboard() {
            const response = await fetch(apiURL);
            const data = await response.json();

            // 1. ìš”ì•½ í†µê³„ ê³„ì‚°
            document.getElementById("total-games").innerText = data.length + "íšŒ";
            const avg = data.reduce((acc, cur) => acc + parseFloat(cur.accuracy), 0) / data.length;
            document.getElementById("avg-acc").innerText = avg.toFixed(1) + "%";
            document.getElementById("high-score").innerText = Math.max(...data.map(d => d.score)) + "ì ";

            // 2. ë™ì‘ë³„ ì„±ê³µ ë¹„ìœ¨ ì°¨íŠ¸ (ì›í˜•)
            const totalPoses = {
                left: data.reduce((acc, cur) => acc + cur.left, 0),
                right: data.reduce((acc, cur) => acc + cur.right, 0),
                both: data.reduce((acc, cur) => acc + cur.both, 0)
            };

            new Chart(document.getElementById('poseChart'), {
                type: 'pie',
                data: {
                    labels: ['ì™¼ì†', 'ì˜¤ë¥¸ì†', 'ì–‘ì†'],
                    datasets: [{
                        data: [totalPoses.left, totalPoses.right, totalPoses.both],
                        backgroundColor: ['#00f3ff', '#ff00ff', '#f5d300']
                    }]
                },
                options: { plugins: { title: { display: true, text: 'ë™ì‘ë³„ ì„±ê³µ ë¶„í¬' } } }
            });

            // 3. ì •í™•ë„ ë³€í™” ì¶”ì´ ì°¨íŠ¸ (êº¾ì€ì„ )
            new Chart(document.getElementById('trendChart'), {
                type: 'line',
                data: {
                    labels: data.map((_, i) => i + 1 + "íšŒì°¨"),
                    datasets: [{
                        label: 'ì •í™•ë„(%)',
                        data: data.map(d => parseFloat(d.accuracy)),
                        borderColor: '#1a1a2e',
                        fill: false
                    }]
                },
                options: { plugins: { title: { display: true, text: 'í•™ìŠµ ì„±ì·¨ë„ ì¶”ì´' } } }
            });
        }

        updateDashboard();
    </script>
</body>
</html>
